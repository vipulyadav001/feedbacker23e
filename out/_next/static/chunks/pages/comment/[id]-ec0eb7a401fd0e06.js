(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[919],{2982:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/comment/[id]",function(){return r(7281)}])},7281:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var o=r(4848),n=r(6540),i=r(6715);function l(){var e;let[t,r]=(0,n.useState)(null),[l,a]=(0,n.useState)(""),c=(0,i.useRouter)(),{id:d}=c.query;(0,n.useEffect)(()=>{d&&s()},[d]);let s=async()=>{try{let e=await fetch("/api/comments");if(e.ok){let t=(await e.json()).find(e=>e.id===Number(d));t&&r(t)}}catch(e){console.error("Error fetching comment:",e)}},p=async e=>{if(e.preventDefault(),l.trim())try{(await fetch("/api/comments?action=reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parentId:null==t?void 0:t.id,text:l})})).ok&&(a(""),s())}catch(e){console.error("Error posting reply:",e)}},u=async(e,r)=>{try{(await fetch("/api/comments?action=likeReply&parentId=".concat(null==t?void 0:t.id,"&replyId=").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unlike:r})})).ok&&(localStorage.setItem("liked_reply_".concat(e),(!r).toString()),s())}catch(e){console.error("Error liking reply:",e)}},y=async e=>{if(confirm("Are you sure you want to delete this reply?"))try{let r=await fetch("/api/comments?action=deleteReply&parentId=".concat(null==t?void 0:t.id,"&replyId=").concat(e),{method:"DELETE",headers:{Accept:"application/json"}});if(!r.ok){let e=await r.json();console.error("Delete reply error:",e);return}s()}catch(e){console.error("Error deleting reply:",e)}};return t?(0,o.jsxs)("div",{style:{padding:"20px",width:"39.7vw",margin:"0 auto"},children:[(0,o.jsx)("button",{onClick:()=>c.push("/"),style:{padding:"8px 16px",marginBottom:"20px",cursor:"pointer"},children:"← Back"}),(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderRadius:"4px",marginBottom:"20px"},children:[(0,o.jsx)("p",{children:t.text}),(0,o.jsx)("small",{style:{color:"#666"},children:new Date(t.createdAt).toLocaleString()})]}),(0,o.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,o.jsx)("h3",{children:"Replies"}),null===(e=t.replies)||void 0===e?void 0:e.map(e=>(0,o.jsxs)("div",{style:{padding:"10px",backgroundColor:"#fff",borderRadius:"4px",marginBottom:"10px",border:"1px solid #ddd"},children:[(0,o.jsx)("p",{children:e.text}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("small",{style:{color:"#666"},children:new Date(e.createdAt).toLocaleString()}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("button",{onClick:t=>{t.stopPropagation();let r="true"===localStorage.getItem("liked_reply_".concat(e.id));u(e.id,r)},style:{border:"none",background:"none",cursor:"pointer",marginRight:"10px",color:"true"===localStorage.getItem("liked_reply_".concat(e.id))?"#ff4b4b":"#666"},children:["true"===localStorage.getItem("liked_reply_".concat(e.id))?"❤️":"\uD83D\uDDA4"," ",e.likes||0]}),(0,o.jsx)("button",{onClick:()=>y(e.id),style:{border:"none",background:"none",cursor:"pointer"},children:"\uD83D\uDDD1️"})]})]})]},e.id))]}),(0,o.jsxs)("form",{onSubmit:p,children:[(0,o.jsx)("textarea",{value:l,onChange:e=>a(e.target.value),placeholder:"Write a reply...",style:{width:"100%",padding:"8px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #ccc"}}),(0,o.jsx)("button",{type:"submit",style:{padding:"8px 16px",backgroundColor:"#1a8cd8",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Post Reply"})]})]}):(0,o.jsx)("div",{children:"Loading..."})}},6715:(e,t,r)=>{e.exports=r(8440)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(2982)),_N_E=e.O()}]);